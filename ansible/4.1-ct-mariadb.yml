---
- name: Install MariaDB
  hosts: mariadb
  handlers:
    - import_tasks: handlers/main.yml
  roles:
    - full-upgrade
    - personalize
    - rsyslog
    - unprivileged-user
  tasks:
    - name: Install APT Packages
      apt:
        pkg:
        - mariadb-server
        - default-libmysqlclient-dev # required for python mysqlclient package
        - python3-pip

    - name:  Copy Configuration File
      copy:
        src: tcp-listen.cnf
        dest: /etc/mysql/mariadb.conf.d/51-tcp-listen.cnf

    - name: Install Python Packages
      pip:
        name:
        - mysqlclient

    - name: Check a var 
      mysql_variables:
        variable: bind_address
        login_unix_socket: /run/mysqld/mysqld.sock
      register: dbout
    
    - debug:
        var: dbout
